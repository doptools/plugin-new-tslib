"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.uninstallPlugin = exports.installPlugin = exports.writeCliPackageJson = exports.readCliPackageJson = exports.PATH_CLI = exports.PATH_CLI_PACKAGEJSON = exports.PATH_CLI_BIN = void 0;
const tslib_1 = require("tslib");
const tslib_cli_core_1 = require("@doptools/tslib-cli-core");
const rest_1 = require("@octokit/rest");
const fs_1 = require("fs");
const http_1 = tslib_1.__importDefault(require("http"));
const jsonc_1 = require("jsonc");
const npm_package_arg_1 = tslib_1.__importDefault(require("npm-package-arg"));
const path_1 = tslib_1.__importDefault(require("path"));
const resolve_package_path_1 = tslib_1.__importStar(require("resolve-package-path"));
const DefaultPluginInstallOptions = {
    force: false,
    verbose: false,
};
async function resolvePackageInfo(plugin) {
    const result = npm_package_arg_1.default(plugin);
    switch (result.type) {
        case 'version':
        case 'tag':
            break;
        case 'directory':
            const pluginPkg = await jsonc_1.jsonc.read(path_1.default.join(result.fetchSpec, 'package.json'));
            addPackageInfo(result, pluginPkg);
            break;
        case 'git':
            await resolvePackageInfoFromGit(plugin, result);
            break;
        default:
            console.warn('unsuported:', result);
            return null;
    }
    return result;
}
function addPackageInfo(result, pkg) {
    result.name = pkg.name;
    result.escapedName = escape(result.name);
    if (result.name.startsWith('@')) {
        result.scope = result.name.split('/', 2)[0];
    }
}
async function resolvePackageInfoFromGit(plugin, info) {
    var _a;
    switch (info.hosted.type) {
        case 'github':
            const gh = info.hosted;
            const api = new rest_1.Octokit();
            (_a = info.gitCommittish) !== null && _a !== void 0 ? _a : (info.gitCommittish = (await api.repos.get({ owner: gh.user, repo: gh.project })).data.default_branch);
            const fileinfo = await api.repos.getContent({
                owner: gh.user,
                repo: gh.project,
                ref: info.gitCommittish,
                path: 'package.json'
            });
            let pkgContent = '';
            if (!fileinfo.data.content) {
                const res = await new Promise(resolve => {
                    http_1.default.get(fileinfo.data.download_url, resolve);
                });
                let data = await new Promise((resolve, reject) => {
                    let data = '';
                    res.on('data', chunk => data += chunk);
                    res.on('error', err => reject(err));
                    res.on('end', () => resolve(data));
                });
                pkgContent = jsonc_1.jsonc.parse(data);
            }
            else {
                const content = fileinfo.data.content;
                pkgContent = Buffer.from(content, 'base64').toString('utf-8');
            }
            const pkg = jsonc_1.jsonc.parse(pkgContent, { stripComments: true });
            addPackageInfo(info, pkg);
            break;
        default:
            throw new Error(`unsupported git host ${info.hosted.type}`);
    }
}
exports.PATH_CLI_BIN = path_1.default.dirname(fs_1.realpathSync(process.argv[1]));
exports.PATH_CLI_PACKAGEJSON = resolve_package_path_1.findUpPackagePath(exports.PATH_CLI_BIN);
exports.PATH_CLI = path_1.default.dirname(exports.PATH_CLI_PACKAGEJSON);
async function readCliPackageJson() {
    return await jsonc_1.jsonc.read(exports.PATH_CLI_PACKAGEJSON);
}
exports.readCliPackageJson = readCliPackageJson;
async function writeCliPackageJson(data) {
    return await jsonc_1.jsonc.write(exports.PATH_CLI_PACKAGEJSON, data, { space: 2 });
}
exports.writeCliPackageJson = writeCliPackageJson;
async function installPlugin(config, plugin, opts = {}) {
    var _a, _b, _c;
    var _d;
    const pluginSource = await resolvePackageInfo(plugin);
    if (pluginSource === null) {
        throw new Error(`Usupported plugin source: '${plugin}'`);
    }
    const pluginName = pluginSource.name;
    const pluginSpec = {
        type: 'user',
        name: pluginName,
        url: pluginSource.raw,
        tag: (_a = pluginSource.gitCommittish) !== null && _a !== void 0 ? _a : pluginSource.fetchSpec
    };
    if (process.env.GLOBAL_CLI !== 'true') {
        const localPkgPath = path_1.default.join(process.cwd(), 'package.json');
        const localPkg = await jsonc_1.jsonc.read(localPkgPath, { stripComments: true });
        (_b = localPkg.dops) !== null && _b !== void 0 ? _b : (localPkg.dops = {});
        (_c = (_d = localPkg.dops).plugins) !== null && _c !== void 0 ? _c : (_d.plugins = []);
        const index = localPkg.dops.plugins.findIndex(p => pluginName === p.name);
        if (index === -1) {
            localPkg.dops.plugins.push(pluginSpec);
        }
        else {
            localPkg.dops.plugins.splice(index, 1, pluginSpec);
        }
        await jsonc_1.jsonc.write(localPkgPath, localPkg, { space: 2 });
    }
    await installPluginSpec(pluginSpec);
}
exports.installPlugin = installPlugin;
async function installPluginSpec(pluginSpec) {
    var _a;
    var _b;
    const plugin = pluginSpec.url;
    const pluginName = pluginSpec.name;
    const installed = !!resolve_package_path_1.default(pluginName, exports.PATH_CLI);
    let code;
    if (code = tslib_cli_core_1.Yarn.add(plugin, { cwd: exports.PATH_CLI })) {
        throw new Error(`Could not add package '${plugin}'. Yarn exited with code: ${code}`);
    }
    const pluginPkgPath = resolve_package_path_1.default(pluginName, exports.PATH_CLI, false);
    const pluginPkg = await jsonc_1.jsonc.read(pluginPkgPath);
    if (!pluginPkg.oclif) {
        if (!installed) {
            tslib_cli_core_1.Yarn.remove(plugin, { cwd: exports.PATH_CLI });
        }
        throw new Error(`'${plugin} is not a valid plugin`);
    }
    const cliPackage = await readCliPackageJson();
    (_a = (_b = cliPackage.oclif).plugins) !== null && _a !== void 0 ? _a : (_b.plugins = []);
    const plugins = cliPackage.oclif.plugins;
    const index = plugins.findIndex(p => typeof p === 'string' ? pluginName === p : pluginName === p.name);
    if (index === -1) {
        plugins.push(pluginSpec);
    }
    else {
        if (typeof plugins[index] !== 'string') {
            plugins.splice(index, 1, pluginSpec);
        }
    }
    await writeCliPackageJson(cliPackage);
}
async function uninstallPlugin(config, plugin, opts = {}) {
    var _a;
    var _b;
    const cliPackage = await readCliPackageJson();
    (_a = (_b = cliPackage.oclif).plugins) !== null && _a !== void 0 ? _a : (_b.plugins = []);
    const plugins = cliPackage.oclif.plugins;
    const index = plugins.findIndex(p => typeof p === 'string' ? plugin === p : plugin === p.name);
    if (index !== -1) {
        plugins.splice(index, 1);
    }
    await writeCliPackageJson(cliPackage);
    tslib_cli_core_1.Yarn.remove(plugin, { cwd: exports.PATH_CLI });
}
exports.uninstallPlugin = uninstallPlugin;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGx1Z2lucy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL3BsdWdpbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLDZEQUFnRDtBQUVoRCx3Q0FBd0M7QUFDeEMsMkJBQWtDO0FBQ2xDLHdEQUF3QjtBQUN4QixpQ0FBOEI7QUFDOUIsOEVBQTBDO0FBQzFDLHdEQUF3QjtBQUN4QixxRkFBeUU7QUFRekUsTUFBTSwyQkFBMkIsR0FBMEI7SUFDdkQsS0FBSyxFQUFFLEtBQUs7SUFDWixPQUFPLEVBQUUsS0FBSztDQUNqQixDQUFBO0FBSUQsS0FBSyxVQUFVLGtCQUFrQixDQUFDLE1BQWM7SUFDNUMsTUFBTSxNQUFNLEdBQUcseUJBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNuQyxRQUFRLE1BQU0sQ0FBQyxJQUFJLEVBQUU7UUFDakIsS0FBSyxTQUFTLENBQUM7UUFDZixLQUFLLEtBQUs7WUFDTixNQUFNO1FBQ1YsS0FBSyxXQUFXO1lBQ1osTUFBTSxTQUFTLEdBQUcsTUFBTSxhQUFLLENBQUMsSUFBSSxDQUFDLGNBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVUsRUFBRSxjQUFjLENBQUMsQ0FBZ0IsQ0FBQztZQUNoRyxjQUFjLENBQUMsTUFBTSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQ2xDLE1BQU07UUFDVixLQUFLLEtBQUs7WUFDTixNQUFNLHlCQUF5QixDQUFDLE1BQU0sRUFBRSxNQUFxQyxDQUFDLENBQUM7WUFDL0UsTUFBTTtRQUNWO1lBQ0ksT0FBTyxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsTUFBTSxDQUFDLENBQUE7WUFDbkMsT0FBTyxJQUFJLENBQUM7S0FDbkI7SUFDRCxPQUFPLE1BQU0sQ0FBQztBQUNsQixDQUFDO0FBRUQsU0FBUyxjQUFjLENBQUMsTUFBMEIsRUFBRSxHQUFnQjtJQUNoRSxNQUFNLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxJQUFLLENBQUM7SUFDeEIsTUFBTSxDQUFDLFdBQVcsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3pDLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLEVBQUU7UUFDN0IsTUFBTSxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDL0M7QUFDTCxDQUFDO0FBRUQsS0FBSyxVQUFVLHlCQUF5QixDQUFDLE1BQWMsRUFBRSxJQUFpQzs7SUFDdEYsUUFBUSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRTtRQUN0QixLQUFLLFFBQVE7WUFDVCxNQUFNLEVBQUUsR0FBc0QsSUFBSSxDQUFDLE1BQU0sQ0FBQztZQUMxRSxNQUFNLEdBQUcsR0FBRyxJQUFJLGNBQU8sRUFBRSxDQUFDO1lBQzFCLE1BQUEsSUFBSSxDQUFDLGFBQWEsb0NBQWxCLElBQUksQ0FBQyxhQUFhLEdBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsRUFBQztZQUN2RyxNQUFNLFFBQVEsR0FBRyxNQUFNLEdBQUcsQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDO2dCQUN4QyxLQUFLLEVBQUUsRUFBRSxDQUFDLElBQUk7Z0JBQ2QsSUFBSSxFQUFFLEVBQUUsQ0FBQyxPQUFPO2dCQUNoQixHQUFHLEVBQUUsSUFBSSxDQUFDLGFBQWE7Z0JBQ3ZCLElBQUksRUFBRSxjQUFjO2FBQ3ZCLENBQUMsQ0FBQTtZQUNGLElBQUksVUFBVSxHQUFHLEVBQUUsQ0FBQztZQUVwQixJQUFJLENBQUUsUUFBUSxDQUFDLElBQVksQ0FBQyxPQUFPLEVBQUU7Z0JBQ2pDLE1BQU0sR0FBRyxHQUFHLE1BQU0sSUFBSSxPQUFPLENBQXVCLE9BQU8sQ0FBQyxFQUFFO29CQUMxRCxjQUFJLENBQUMsR0FBRyxDQUFFLFFBQVEsQ0FBQyxJQUFZLENBQUMsWUFBWSxFQUFFLE9BQU8sQ0FBQyxDQUFDO2dCQUMzRCxDQUFDLENBQUMsQ0FBQztnQkFDSCxJQUFJLElBQUksR0FBRyxNQUFNLElBQUksT0FBTyxDQUFTLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO29CQUNyRCxJQUFJLElBQUksR0FBRyxFQUFFLENBQUM7b0JBQ2QsR0FBRyxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLEVBQUUsQ0FBQyxJQUFJLElBQUksS0FBSyxDQUFDLENBQUM7b0JBQ3ZDLEdBQUcsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7b0JBQ3BDLEdBQUcsQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO2dCQUN2QyxDQUFDLENBQUMsQ0FBQztnQkFDSCxVQUFVLEdBQUcsYUFBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQTthQUVqQztpQkFBTTtnQkFDSCxNQUFNLE9BQU8sR0FBSSxRQUFRLENBQUMsSUFBWSxDQUFDLE9BQWlCLENBQUM7Z0JBQ3pELFVBQVUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7YUFDakU7WUFDRCxNQUFNLEdBQUcsR0FBRyxhQUFLLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxFQUFFLGFBQWEsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQzdELGNBQWMsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUM7WUFDMUIsTUFBTTtRQUNWO1lBQ0ksTUFBTSxJQUFJLEtBQUssQ0FBQyx3QkFBd0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFBO0tBRWxFO0FBQ0wsQ0FBQztBQUdZLFFBQUEsWUFBWSxHQUFHLGNBQUksQ0FBQyxPQUFPLENBQUMsaUJBQVksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUMzRCxRQUFBLG9CQUFvQixHQUFHLHdDQUFpQixDQUFDLG9CQUFZLENBQUMsQ0FBQztBQUN2RCxRQUFBLFFBQVEsR0FBRyxjQUFJLENBQUMsT0FBTyxDQUFDLDRCQUFvQixDQUFDLENBQUM7QUFHcEQsS0FBSyxVQUFVLGtCQUFrQjtJQUNwQyxPQUFPLE1BQU0sYUFBSyxDQUFDLElBQUksQ0FBQyw0QkFBb0IsQ0FBZ0IsQ0FBQztBQUNqRSxDQUFDO0FBRkQsZ0RBRUM7QUFFTSxLQUFLLFVBQVUsbUJBQW1CLENBQUMsSUFBaUI7SUFDdkQsT0FBTyxNQUFNLGFBQUssQ0FBQyxLQUFLLENBQUMsNEJBQW9CLEVBQUUsSUFBSSxFQUFFLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7QUFDdkUsQ0FBQztBQUZELGtEQUVDO0FBSU0sS0FBSyxVQUFVLGFBQWEsQ0FBQyxNQUFlLEVBQUUsTUFBYyxFQUFFLE9BQXVDLEVBQUU7OztJQUMxRyxNQUFNLFlBQVksR0FBRyxNQUFNLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3RELElBQUksWUFBWSxLQUFLLElBQUksRUFBRTtRQUN2QixNQUFNLElBQUksS0FBSyxDQUFDLDhCQUE4QixNQUFNLEdBQUcsQ0FBQyxDQUFDO0tBQzVEO0lBQ0QsTUFBTSxVQUFVLEdBQUcsWUFBWSxDQUFDLElBQUssQ0FBQztJQUN0QyxNQUFNLFVBQVUsR0FBRztRQUNmLElBQUksRUFBRSxNQUFNO1FBQ1osSUFBSSxFQUFFLFVBQVU7UUFDaEIsR0FBRyxFQUFFLFlBQVksQ0FBQyxHQUFHO1FBQ3JCLEdBQUcsUUFBRSxZQUFZLENBQUMsYUFBYSxtQ0FBSSxZQUFZLENBQUMsU0FBUztLQUNsQyxDQUFDO0lBRTVCLElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEtBQUssTUFBTSxFQUFFO1FBQ25DLE1BQU0sWUFBWSxHQUFHLGNBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxFQUFFLGNBQWMsQ0FBQyxDQUFDO1FBRTlELE1BQU0sUUFBUSxHQUFHLE1BQU0sYUFBSyxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsRUFBRSxhQUFhLEVBQUUsSUFBSSxFQUFFLENBQW9FLENBQUM7UUFDNUksTUFBQSxRQUFRLENBQUMsSUFBSSxvQ0FBYixRQUFRLENBQUMsSUFBSSxHQUFLLEVBQUUsRUFBQztRQUNyQixZQUFBLFFBQVEsQ0FBQyxJQUFJLEVBQUMsT0FBTyx1Q0FBUCxPQUFPLEdBQUssRUFBRSxFQUFDO1FBQzdCLE1BQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLFVBQVUsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUUsSUFBSSxLQUFLLEtBQUssQ0FBQyxDQUFDLEVBQUU7WUFDZCxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7U0FDMUM7YUFBTTtZQUNILFFBQVEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxFQUFFLFVBQVUsQ0FBQyxDQUFDO1NBQ3REO1FBQ0QsTUFBTSxhQUFLLENBQUMsS0FBSyxDQUFDLFlBQVksRUFBRSxRQUFRLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztLQUMzRDtJQUVELE1BQU0saUJBQWlCLENBQUMsVUFBVSxDQUFDLENBQUM7QUFDeEMsQ0FBQztBQTdCRCxzQ0E2QkM7QUFFRCxLQUFLLFVBQVUsaUJBQWlCLENBQUMsVUFBa0M7OztJQUMvRCxNQUFNLE1BQU0sR0FBRyxVQUFVLENBQUMsR0FBSSxDQUFDO0lBQy9CLE1BQU0sVUFBVSxHQUFHLFVBQVUsQ0FBQyxJQUFLLENBQUM7SUFDcEMsTUFBTSxTQUFTLEdBQUcsQ0FBQyxDQUFDLDhCQUFjLENBQUMsVUFBVSxFQUFFLGdCQUFRLENBQUMsQ0FBQztJQUN6RCxJQUFJLElBQUksQ0FBQztJQUNULElBQUksSUFBSSxHQUFHLHFCQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxFQUFFLEdBQUcsRUFBRSxnQkFBUSxFQUFFLENBQUMsRUFBRTtRQUM1QyxNQUFNLElBQUksS0FBSyxDQUFDLDBCQUEwQixNQUFNLDZCQUE2QixJQUFJLEVBQUUsQ0FBQyxDQUFDO0tBQ3hGO0lBRUQsTUFBTSxhQUFhLEdBQUcsOEJBQWMsQ0FBQyxVQUFVLEVBQUUsZ0JBQVEsRUFBRSxLQUFLLENBQUUsQ0FBQztJQUNuRSxNQUFNLFNBQVMsR0FBRyxNQUFNLGFBQUssQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFpQixDQUFDO0lBQ2xFLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFO1FBQ2xCLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDWixxQkFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsRUFBRSxHQUFHLEVBQUUsZ0JBQVEsRUFBRSxDQUFDLENBQUM7U0FDMUM7UUFDRCxNQUFNLElBQUksS0FBSyxDQUFDLElBQUksTUFBTSx3QkFBd0IsQ0FBQyxDQUFDO0tBQ3ZEO0lBRUQsTUFBTSxVQUFVLEdBQUcsTUFBTSxrQkFBa0IsRUFBZ0IsQ0FBQztJQUU1RCxZQUFBLFVBQVUsQ0FBQyxLQUFLLEVBQUMsT0FBTyx1Q0FBUCxPQUFPLEdBQUssRUFBRSxFQUFDO0lBQ2hDLE1BQU0sT0FBTyxHQUFHLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDO0lBR3pDLE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLFVBQVUsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDdkcsSUFBSSxLQUFLLEtBQUssQ0FBQyxDQUFDLEVBQUU7UUFDZCxPQUFPLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0tBQzVCO1NBQU07UUFDSCxJQUFJLE9BQU8sT0FBTyxDQUFDLEtBQUssQ0FBQyxLQUFLLFFBQVEsRUFBRTtZQUNwQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLEVBQUUsVUFBVSxDQUFDLENBQUM7U0FDeEM7S0FDSjtJQUVELE1BQU0sbUJBQW1CLENBQUMsVUFBVSxDQUFDLENBQUM7QUFDMUMsQ0FBQztBQUVNLEtBQUssVUFBVSxlQUFlLENBQUMsTUFBZSxFQUFFLE1BQWMsRUFBRSxPQUF1QyxFQUFFOzs7SUFDNUcsTUFBTSxVQUFVLEdBQUcsTUFBTSxrQkFBa0IsRUFBZ0IsQ0FBQztJQUM1RCxZQUFBLFVBQVUsQ0FBQyxLQUFLLEVBQUMsT0FBTyx1Q0FBUCxPQUFPLEdBQUssRUFBRSxFQUFDO0lBQ2hDLE1BQU0sT0FBTyxHQUFHLFVBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDO0lBQ3pDLE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsS0FBSyxRQUFRLENBQUMsQ0FBQyxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDL0YsSUFBSSxLQUFLLEtBQUssQ0FBQyxDQUFDLEVBQUU7UUFDZCxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztLQUM1QjtJQUNELE1BQU0sbUJBQW1CLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDdEMscUJBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFLEVBQUUsR0FBRyxFQUFFLGdCQUFRLEVBQUUsQ0FBQyxDQUFDO0FBQzNDLENBQUM7QUFWRCwwQ0FVQyJ9