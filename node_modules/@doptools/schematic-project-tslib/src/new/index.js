"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const core_1 = require("@angular-devkit/core");
const schematics_1 = require("@angular-devkit/schematics");
const tasks_1 = require("@angular-devkit/schematics/tasks");
function default_1(options) {
    if (!options.directory) {
        if (options.name.startsWith('@')) {
            options.directory = core_1.strings.dasherize(options.name.split('/')[1]);
        }
        else {
            options.directory = core_1.strings.dasherize(options.name);
        }
    }
    const baseOptions = Object.assign({}, options);
    //const packageName = (scope ? `@${scope}/` : '') + name;
    return schematics_1.chain([
        schematics_1.mergeWith(schematics_1.apply(schematics_1.empty(), [
            schematics_1.schematic("project", baseOptions),
            schematics_1.move(options.directory),
        ])),
        (_host, context) => {
            let packageTask;
            if (!options.skipInstall) {
                packageTask = context.addTask(new tasks_1.NodePackageInstallTask({
                    workingDirectory: options.directory,
                    packageManager: "yarn",
                }));
            }
            if (!options.skipGit) {
                const commit = typeof options.commit == "object"
                    ? options.commit
                    : !!options.commit
                        ? {}
                        : false;
                context.addTask(new tasks_1.RepositoryInitializerTask(options.directory, commit), packageTask ? [packageTask] : []);
            }
        },
    ]);
}
exports.default = default_1;
//# sourceMappingURL=index.js.map